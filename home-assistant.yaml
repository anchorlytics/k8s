---
apiVersion: v1
kind: Namespace
metadata:
  name: home-assistant

---
apiVersion: helm.cattle.io/v1
kind: HelmChart
metadata:
  name: home-assistant
  namespace: kube-system
spec:
  repo: "https://k8s-at-home.com/charts"
  chart: home-assistant
  version: 5.4.4
  targetNamespace: home-assistant
  valuesContent: |-
    ingress:
      enabled: true
      hosts:
      - host: ha.home.seanho.com
        paths:
        - path: /
      tls:
      - secretName: ha-tls
        hosts:
        - ha.home.seanho.com
    persistence:
      config:
        enabled: true
    postgresql:
      enabled: true
      persistence:
        enabled: true
    prometheus:
      serviceMonitor:
        enabled: false
    securityContext:
      privileged: true
    additionalVolumes:
    - name: zwave-usb
      hostPath:
        path: /dev/ttyACM0
    additionalVolumeMounts:
    - name: zwave-usb
      mountPath: /dev/ttyACM0
    affinity:
      nodeAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
          nodeSelectorTerms:
          - matchExpressions:
            - key: device
              operator: In
              values:
              - zwave
